{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\n\nvar _this = this,\n    _jsxFileName = \"D:\\\\Coding\\\\covid-web-develop\\\\covid-web-develop\\\\pages\\\\components\\\\component.snapshot.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from \"react\";\nimport Webcam from \"react-webcam\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { updateFirstName, updateLastName, updateSsid } from \"../../store/actions/postAction\";\nimport img1 from \"../../public/1.png\";\nimport Router from \"next/router\";\nimport Axios from \"axios\";\nvar FormItem = _Form.Item;\n\nvar WebcamCapture = function WebcamCapture(props) {\n  _s();\n\n  var dispatch = useDispatch();\n  var webcamRef = React.useRef(null);\n\n  var _useState = useState(\"\"),\n      data = _useState[0],\n      setData = _useState[1];\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      imgSrc = _React$useState2[0],\n      setImgSrc = _React$useState2[1];\n\n  var _useSelector = useSelector(function (state) {\n    return state.post;\n  }),\n      SSID = _useSelector.SSID;\n\n  var token = \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mbyI6eyJ1c2VybmFtZSI6ImtrayIsImZpcnN0X25hbWUiOiJiYmJiIiwibGFzdF9uYW1lIjoiY2NjYyIsInJvbGUiOiIzIiwiZGVwYXJ0bWVudF9uYW1lX3RoIjoi4LmA4LmA4Lie4LiX4Lii4LmMIiwiZGVwYXJ0bWVudF9uYW1lX2VuIjoiZG9jdG9yIiwiZGVwYXJ0bWVudF9mdWxsX25hbWUiOiLguYDguYDguJ7guJfguKLguYwifSwiaWF0IjoxNTk1MzA4NDA2LCJleHAiOjE1OTUzMTAyMDZ9.Ymc7CjCGPZjy46k40miXJdvw8NHjzmnJC-lpMfu5POh3OT39e29kpf846j8SSgamohrQubtlwv6I6K3s_Il5727RcDInpIz58Zt3D_ctq3ok6Hjf5ZR7KJJlvwrc1mV_Vv5DAaMKt5DxUxhedcLBt1ZeGPxSdbXWnlPog5UPe8ybKENB43Qv_lQpcUQBS1rlA7tBi3FbIzfLLENxDR90p9f4b5y7CSDG-I3fd2uAGQXOAI88k08DHXSn3XegeNsnhOFTxVwQhyguuVF_fYVtErMo1uyXI3YDfE2yRoZvzEIuz4j13MAF4sV32k8UWRpMpK_aeEenZ09L2nJiRMtrvQfvlGpCex44Gylu1wVYZPDxrYUmGGzR0grDz5SYkUfJIhJdMK_UKDwwL5fEgnjhyi3m5OEp_oFzGfPtLKfUXk2WtKeMPJvAl62m6Dpdd3gJ6FofkzxXt19OFWGqcCo3YEhigPOcjYJyZ2xoHMBbStfmwaj3PhVJymGPqLXi_VcPXWGhLyoz503_nSGNBrYZQZkYKD5nHXpv1o3cbjb8szb7HSQBlrUbO60I9nSvaXzDSN3HQZ2pSAqychPAfLTu8DtkmHV2shS2s4v3Yr1P6EyS1cW6nIEOA3M8PatdY3aaK9GnFrSKDo39_6yZWiisQuCflxfxcpCAs3nrwTDp6x4\";\n\n  var Axiosphoto = function Axiosphoto(value) {\n    var Command = value;\n    console.log(Command);\n\n    if (Command === \"Errormask\") {\n      alert(\"กรุณาถอดหน้ากาก\");\n    } else if (Command === \"FoundData\") {\n      var Data = [\"3640600077526\", \"สมชาย\", \"หมายปอง\"];\n      dispatch(updateSsid(Data[0]));\n      dispatch(updateFirstName(Data[1]));\n      dispatch(updateSsid(Data[2]));\n      alert(\"พบข้อมูล\");\n      Router.push(\"/page.covid4\");\n    } else if (Command === \"NotFoundData\") {\n      alert(\"ไม่พบข้อมูล\");\n    }\n  };\n\n  function taskOne() {\n    return new Promise( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(resolve) {\n        var A;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                A = /*#__PURE__*/function () {\n                  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                    var imageSrc, block, contentType, realData, blob;\n                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            _context.next = 2;\n                            return webcamRef.current.getScreenshot();\n\n                          case 2:\n                            imageSrc = _context.sent;\n                            _context.next = 5;\n                            return console.log(imageSrc);\n\n                          case 5:\n                            _context.next = 7;\n                            return ImageURL.split(\";\");\n\n                          case 7:\n                            block = _context.sent;\n                            _context.next = 10;\n                            return block[0].split(\":\")[1];\n\n                          case 10:\n                            contentType = _context.sent;\n                            _context.next = 13;\n                            return block[1].split(\",\")[1];\n\n                          case 13:\n                            realData = _context.sent;\n                            _context.next = 16;\n                            return b64toBlob(realData, contentType);\n\n                          case 16:\n                            blob = _context.sent;\n                            _context.next = 19;\n                            return console.log(blob);\n\n                          case 19:\n                            resolve(blob);\n\n                          case 20:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee);\n                  }));\n\n                  return function A() {\n                    return _ref2.apply(this, arguments);\n                  };\n                }();\n\n                _context2.next = 3;\n                return A();\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n\n  function taskTwo(value) {\n    return new Promise( /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(resolve) {\n        var B, formData;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                B = /*#__PURE__*/function () {\n                  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n                    var formData;\n                    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                      while (1) {\n                        switch (_context3.prev = _context3.next) {\n                          case 0:\n                            _context3.next = 2;\n                            return console.log(\"A\", value);\n\n                          case 2:\n                            _context3.next = 4;\n                            return console.log(\"2\");\n\n                          case 4:\n                            _context3.next = 6;\n                            return new FormData();\n\n                          case 6:\n                            formData = _context3.sent;\n                            _context3.next = 9;\n                            return formData.append(\"picture\", value);\n\n                          case 9:\n                            return _context3.abrupt(\"return\", formData);\n\n                          case 10:\n                          case \"end\":\n                            return _context3.stop();\n                        }\n                      }\n                    }, _callee3);\n                  }));\n\n                  return function B() {\n                    return _ref4.apply(this, arguments);\n                  };\n                }();\n\n                _context4.next = 3;\n                return B();\n\n              case 3:\n                formData = _context4.sent;\n                _context4.next = 6;\n                return console.log(\"3\", formData);\n\n              case 6:\n                _context4.next = 8;\n                return Axios({\n                  method: \"post\",\n                  url: \"http://34.87.54.114:8003/api/v1/file/uploadphoto\",\n                  headers: {\n                    Authorization: \"Bearer \".concat(token),\n                    \"Content-Type\": \"multipart/form-data\"\n                  },\n                  formData: formData\n                }).then(function (res) {\n                  console.log(\"success\", res);\n                })[\"catch\"](function (error) {\n                  console.log(\"error\", error);\n                });\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      return function (_x2) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n  }\n\n  function taskThree() {\n    return new Promise( /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(resolve) {\n        var C;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                C = function C() {\n                  console.log(\"4\");\n                };\n\n                _context5.next = 3;\n                return C();\n\n              case 3:\n                _context5.next = 5;\n                return resolve();\n\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      return function (_x3) {\n        return _ref5.apply(this, arguments);\n      };\n    }());\n  }\n\n  var main = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      var result;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return taskOne();\n\n            case 2:\n              result = _context6.sent;\n              _context6.next = 5;\n              return taskTwo(result);\n\n            case 5:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function main() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var capture = React.useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            //const imageSrc = await webcamRef.current.getScreenshot();\n            main(); //const formData = new FormData();\n            //formData.append('picture');\n            //console.log(formData)\n\n            /*Axios({\r\n                method:\"post\",\r\n                url:\"http://34.87.54.114:8003/api/v1/file/uploadphoto\",\r\n                headers: {\r\n                    Authorization: `Bearer ${token}`,\r\n                    'Content-Type': 'multipart/form-data'\r\n                  },\r\n              data:{ picture:blob}\r\n            }).then((res)=>{\r\n                console.log('success',res)\r\n            }).catch((error)=>{\r\n                console.log('error',error)\r\n            })*/\n            //await console.log(\"1\", data);\n            //await Axiosphoto(\"Errormask\");\n\n          case 1:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  })), [webcamRef, setImgSrc]);\n  /*useEffect(() => {\r\n    const formData = new FormData();\r\n    if (data === \"\") {\r\n    } else {\r\n      console.log(data);\r\n      formData.append(\"picture.png\", data);\r\n      console.log(formData);\r\n    }\r\n  }, [data]);*/\n\n  var _useState2 = useState(null),\n      statee = _useState2[0],\n      setStatee = _useState2[1];\n\n  var fileSelectedHandler = function fileSelectedHandler(event) {\n    setStatee(event.target.files[0]);\n    console.log(event.target.files[0]);\n  };\n\n  var fileUploadHandler = function fileUploadHandler() {\n    console.log(\"TEST\", statee);\n    var fd = new FormData();\n    fd.append(\"picture\", statee);\n    Axios.post(\"http://34.87.54.114:8003/api/v1/file/uploadphoto\", fd, {\n      headers: {\n        Authorization: \"Bearer \".concat(token),\n        \"Content-Type\": \"multipart/form-data\"\n      }\n    }).then(function (res) {\n      console.log(\"success\", res);\n    })[\"catch\"](function (err) {\n      console.log(\"err\", err);\n    });\n  };\n\n  function b64toBlob(b64Data, contentType, sliceSize) {\n    contentType = contentType || \"\";\n    sliceSize = sliceSize || 512;\n    var byteCharacters = atob(b64Data);\n    var byteArrays = [];\n\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n      var slice = byteCharacters.slice(offset, offset + sliceSize);\n      var byteNumbers = new Array(slice.length);\n\n      for (var i = 0; i < slice.length; i++) {\n        byteNumbers[i] = slice.charCodeAt(i);\n      }\n\n      var byteArray = new Uint8Array(byteNumbers);\n      byteArrays.push(byteArray);\n    }\n\n    var blob = new Blob(byteArrays, {\n      type: contentType\n    });\n    return blob;\n  }\n\n  var test = function test() {\n    var ImageURL = data;\n    console.log(ImageURL);\n    var block = ImageURL.split(\";\");\n    var contentType = block[0].split(\":\")[1];\n    var realData = block[1].split(\",\")[1];\n    var blob = b64toBlob(realData, contentType);\n    console.log(blob);\n    var fd = new FormData();\n    fd.append(\"picture\", blob);\n    Axios.post(\"http://34.87.54.114:8003/api/v1/file/uploadphoto\", fd, {\n      headers: {\n        Authorization: \"Bearer \".concat(token),\n        \"Content-Type\": \"multipart/form-data\"\n      }\n    }).then(function (res) {\n      console.log(\"success\", res);\n    })[\"catch\"](function (err) {\n      console.log(\"err\", err);\n    });\n  };\n\n  return __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 5\n    }\n  }, __jsx(FormItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 9\n    }\n  }, __jsx(Webcam, {\n    audio: false,\n    ref: webcamRef,\n    screenshotFormat: \"image/jpeg\",\n    style: {\n      borderRadius: \"20px\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 11\n    }\n  })), __jsx(_Button, {\n    onClick: capture,\n    style: {\n      width: \"100%\"\n    },\n    type: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 9\n    }\n  }, \"Capture photo\"), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 9\n    }\n  }, __jsx(\"img\", {\n    src: imgSrc,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 11\n    }\n  }), __jsx(\"input\", {\n    type: \"file\",\n    onChange: fileSelectedHandler,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 11\n    }\n  }), __jsx(\"button\", {\n    onClick: fileUploadHandler,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 11\n    }\n  }, \"Upload\"), __jsx(\"button\", {\n    onClick: test,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 11\n    }\n  }, \"Upload TEST\"))));\n};\n\n_s(WebcamCapture, \"TFeEcDTnNsw7el/axlsnqJq/VtA=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = WebcamCapture;\nexport default WebcamCapture;\n\nvar _c;\n\n$RefreshReg$(_c, \"WebcamCapture\");","map":{"version":3,"sources":["D:/Coding/covid-web-develop/covid-web-develop/pages/components/component.snapshot.js"],"names":["React","useEffect","useState","Webcam","useDispatch","useSelector","updateFirstName","updateLastName","updateSsid","img1","Router","Axios","FormItem","Item","WebcamCapture","props","dispatch","webcamRef","useRef","data","setData","imgSrc","setImgSrc","state","post","SSID","token","Axiosphoto","value","Command","console","log","alert","Data","push","taskOne","Promise","resolve","A","current","getScreenshot","imageSrc","ImageURL","split","block","contentType","realData","b64toBlob","blob","taskTwo","B","FormData","formData","append","method","url","headers","Authorization","then","res","error","taskThree","C","main","result","capture","useCallback","statee","setStatee","fileSelectedHandler","event","target","files","fileUploadHandler","fd","err","b64Data","sliceSize","byteCharacters","atob","byteArrays","offset","length","slice","byteNumbers","Array","i","charCodeAt","byteArray","Uint8Array","Blob","type","test","borderRadius","width"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Webcam from \"react-webcam\";\r\nimport {\r\n  Form,\r\n  Select,\r\n  InputNumber,\r\n  DatePicker,\r\n  Switch,\r\n  Slider,\r\n  Button,\r\n} from \"antd\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  updateFirstName,\r\n  updateLastName,\r\n  updateSsid,\r\n} from \"../../store/actions/postAction\";\r\nimport img1 from \"../../public/1.png\";\r\nimport Router from \"next/router\";\r\nimport Axios from \"axios\";\r\n\r\nconst FormItem = Form.Item;\r\n\r\nconst WebcamCapture = (props) => {\r\n  const dispatch = useDispatch();\r\n  const webcamRef = React.useRef(null);\r\n  const [data, setData] = useState(\"\");\r\n  const [imgSrc, setImgSrc] = React.useState(null);\r\n  const { SSID } = useSelector((state) => state.post);\r\n  const token =\r\n    \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mbyI6eyJ1c2VybmFtZSI6ImtrayIsImZpcnN0X25hbWUiOiJiYmJiIiwibGFzdF9uYW1lIjoiY2NjYyIsInJvbGUiOiIzIiwiZGVwYXJ0bWVudF9uYW1lX3RoIjoi4LmA4LmA4Lie4LiX4Lii4LmMIiwiZGVwYXJ0bWVudF9uYW1lX2VuIjoiZG9jdG9yIiwiZGVwYXJ0bWVudF9mdWxsX25hbWUiOiLguYDguYDguJ7guJfguKLguYwifSwiaWF0IjoxNTk1MzA4NDA2LCJleHAiOjE1OTUzMTAyMDZ9.Ymc7CjCGPZjy46k40miXJdvw8NHjzmnJC-lpMfu5POh3OT39e29kpf846j8SSgamohrQubtlwv6I6K3s_Il5727RcDInpIz58Zt3D_ctq3ok6Hjf5ZR7KJJlvwrc1mV_Vv5DAaMKt5DxUxhedcLBt1ZeGPxSdbXWnlPog5UPe8ybKENB43Qv_lQpcUQBS1rlA7tBi3FbIzfLLENxDR90p9f4b5y7CSDG-I3fd2uAGQXOAI88k08DHXSn3XegeNsnhOFTxVwQhyguuVF_fYVtErMo1uyXI3YDfE2yRoZvzEIuz4j13MAF4sV32k8UWRpMpK_aeEenZ09L2nJiRMtrvQfvlGpCex44Gylu1wVYZPDxrYUmGGzR0grDz5SYkUfJIhJdMK_UKDwwL5fEgnjhyi3m5OEp_oFzGfPtLKfUXk2WtKeMPJvAl62m6Dpdd3gJ6FofkzxXt19OFWGqcCo3YEhigPOcjYJyZ2xoHMBbStfmwaj3PhVJymGPqLXi_VcPXWGhLyoz503_nSGNBrYZQZkYKD5nHXpv1o3cbjb8szb7HSQBlrUbO60I9nSvaXzDSN3HQZ2pSAqychPAfLTu8DtkmHV2shS2s4v3Yr1P6EyS1cW6nIEOA3M8PatdY3aaK9GnFrSKDo39_6yZWiisQuCflxfxcpCAs3nrwTDp6x4\";\r\n\r\n  const Axiosphoto = (value) => {\r\n    const Command = value;\r\n    console.log(Command);\r\n    if (Command === \"Errormask\") {\r\n      alert(\"กรุณาถอดหน้ากาก\");\r\n    } else if (Command === \"FoundData\") {\r\n      const Data = [\"3640600077526\", \"สมชาย\", \"หมายปอง\"];\r\n      dispatch(updateSsid(Data[0]));\r\n      dispatch(updateFirstName(Data[1]));\r\n      dispatch(updateSsid(Data[2]));\r\n      alert(\"พบข้อมูล\");\r\n      Router.push(\"/page.covid4\");\r\n    } else if (Command === \"NotFoundData\") {\r\n      alert(\"ไม่พบข้อมูล\");\r\n    }\r\n  };\r\n\r\n  function taskOne() {\r\n    return new Promise(async (resolve) => {\r\n      const A = async () => {\r\n        const imageSrc = await webcamRef.current.getScreenshot();\r\n        await console.log(imageSrc);\r\n        var block = await ImageURL.split(\";\");\r\n        var contentType = await block[0].split(\":\")[1];\r\n        var realData = await block[1].split(\",\")[1];\r\n        var blob = await b64toBlob(realData, contentType);\r\n        await console.log(blob);\r\n        resolve(blob)\r\n      };\r\n      await A();\r\n    });\r\n  }\r\n  function taskTwo(value) {\r\n    return new Promise(async (resolve) => {\r\n      const B = async () => {\r\n        await console.log(\"A\", value);\r\n        await console.log(\"2\");\r\n        const formData = await new FormData();\r\n        await formData.append(\"picture\", value);\r\n        return formData;\r\n      };\r\n      var formData = await B();\r\n      await console.log(\"3\", formData);\r\n      await Axios({\r\n        method: \"post\",\r\n        url: \"http://34.87.54.114:8003/api/v1/file/uploadphoto\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n        formData,\r\n      })\r\n        .then((res) => {\r\n          console.log(\"success\", res);\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"error\", error);\r\n        });\r\n    });\r\n  }\r\n  function taskThree() {\r\n    return new Promise(async (resolve) => {\r\n      const C = () => {\r\n        console.log(\"4\");\r\n      };\r\n      await C();\r\n      await resolve();\r\n    });\r\n  }\r\n\r\n  const main = async () => {\r\n    var result = await taskOne();\r\n    await taskTwo(result);\r\n    //await taskThree();\r\n  };\r\n\r\n  const capture = React.useCallback(async () => {\r\n    //const imageSrc = await webcamRef.current.getScreenshot();\r\n    main();\r\n    //const formData = new FormData();\r\n    //formData.append('picture');\r\n    //console.log(formData)\r\n    /*Axios({\r\n        method:\"post\",\r\n        url:\"http://34.87.54.114:8003/api/v1/file/uploadphoto\",\r\n        headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'multipart/form-data'\r\n          },\r\n      data:{ picture:blob}\r\n    }).then((res)=>{\r\n        console.log('success',res)\r\n    }).catch((error)=>{\r\n        console.log('error',error)\r\n    })*/\r\n    //await console.log(\"1\", data);\r\n    //await Axiosphoto(\"Errormask\");\r\n  }, [webcamRef, setImgSrc]);\r\n  /*useEffect(() => {\r\n    const formData = new FormData();\r\n    if (data === \"\") {\r\n    } else {\r\n      console.log(data);\r\n      formData.append(\"picture.png\", data);\r\n      console.log(formData);\r\n    }\r\n  }, [data]);*/\r\n  const [statee, setStatee] = useState(null);\r\n  const fileSelectedHandler = (event) => {\r\n    setStatee(event.target.files[0]);\r\n    console.log(event.target.files[0]);\r\n  };\r\n  const fileUploadHandler = () => {\r\n    console.log(\"TEST\", statee);\r\n    const fd = new FormData();\r\n    fd.append(\"picture\", statee);\r\n    Axios.post(\"http://34.87.54.114:8003/api/v1/file/uploadphoto\", fd, {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    })\r\n      .then((res) => {\r\n        console.log(\"success\", res);\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"err\", err);\r\n      });\r\n  };\r\n\r\n  function b64toBlob(b64Data, contentType, sliceSize) {\r\n    contentType = contentType || \"\";\r\n    sliceSize = sliceSize || 512;\r\n    var byteCharacters = atob(b64Data);\r\n    var byteArrays = [];\r\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n      var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n      var byteNumbers = new Array(slice.length);\r\n      for (var i = 0; i < slice.length; i++) {\r\n        byteNumbers[i] = slice.charCodeAt(i);\r\n      }\r\n      var byteArray = new Uint8Array(byteNumbers);\r\n      byteArrays.push(byteArray);\r\n    }\r\n    var blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n  }\r\n\r\n  const test = () => {\r\n    var ImageURL = data;\r\n    console.log(ImageURL);\r\n    var block = ImageURL.split(\";\");\r\n    var contentType = block[0].split(\":\")[1];\r\n    var realData = block[1].split(\",\")[1];\r\n    var blob = b64toBlob(realData, contentType);\r\n    console.log(blob);\r\n    const fd = new FormData();\r\n    fd.append(\"picture\", blob);\r\n    Axios.post(\"http://34.87.54.114:8003/api/v1/file/uploadphoto\", fd, {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    })\r\n      .then((res) => {\r\n        console.log(\"success\", res);\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"err\", err);\r\n      });\r\n  };\r\n  return (\r\n    <div>\r\n      <FormItem>\r\n        <div>\r\n          <Webcam\r\n            audio={false}\r\n            ref={webcamRef}\r\n            screenshotFormat=\"image/jpeg\"\r\n            style={{ borderRadius: \"20px\" }}\r\n          />\r\n        </div>\r\n        <Button onClick={capture} style={{ width: \"100%\" }} type=\"primary\">\r\n          Capture photo\r\n        </Button>\r\n        <div>\r\n          <img src={imgSrc} />\r\n          <input type=\"file\" onChange={fileSelectedHandler} />\r\n          <button onClick={fileUploadHandler}>Upload</button>\r\n          <button onClick={test}>Upload TEST</button>\r\n        </div>\r\n      </FormItem>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WebcamCapture;\r\n"]},"metadata":{},"sourceType":"module"}