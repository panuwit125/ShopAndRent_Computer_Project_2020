{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nvar _jsxFileName = \"D:\\\\Coding\\\\covid-web-develop\\\\covid-web-develop\\\\pages\\\\components\\\\component.snapshot.js\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from \"react\";\nimport Webcam from \"react-webcam\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { updateFirstName, updateLastName, updateSsid } from \"../../store/actions/postAction\";\nimport img1 from \"../../public/1.png\";\nimport Router from \"next/router\";\nimport Axios from \"axios\";\nconst FormItem = _Form.Item;\n\nconst WebcamCapture = props => {\n  const dispatch = useDispatch();\n  const webcamRef = React.useRef(null);\n  const {\n    0: data,\n    1: setData\n  } = useState(\"\");\n  const [imgSrc, setImgSrc] = React.useState(null);\n  const {\n    SSID\n  } = useSelector(state => state.post);\n  const token = \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mbyI6eyJ1c2VybmFtZSI6ImtrayIsImZpcnN0X25hbWUiOiJiYmJiIiwibGFzdF9uYW1lIjoiY2NjYyIsInJvbGUiOiIzIiwiZGVwYXJ0bWVudF9uYW1lX3RoIjoi4LmA4LmA4Lie4LiX4Lii4LmMIiwiZGVwYXJ0bWVudF9uYW1lX2VuIjoiZG9jdG9yIiwiZGVwYXJ0bWVudF9mdWxsX25hbWUiOiLguYDguYDguJ7guJfguKLguYwifSwiaWF0IjoxNTk1MjYzOTEwLCJleHAiOjE1OTUyNjU3MTB9.SpszxcoVLCt49PKRXq_d9fVL2xT6VMyQwka54554SgZYJzAPDc1REOi_fgj1SppKckXBE5pE63SlHkP1tkifkgUw9FwQiRFEysds0_u4EhRteu4IBy-QMCtJPjieWYQ38HKDns8baLKVBE-kuOhQ9wKEzt4mGDwF-fYHcZ9kzFImkNSHHft_y9HQIb-sjUCNzp6G59YHm75yG1Pqf3rIAeuHk-Vgol_5bX6ANpGGOLJR_vMS9Csk18I9rrRVdZVne45JcEEJBLitVglkU74zxkECXev4yVKCuOPfclPnCuLCal16sUHaA9XNrCYog24fB5CfTOV8Qz3grnH36kKw71sbtUjygJ7Zp4e4f8fJnyjEpP_FJLpi6_VTo-HLqQvi-x6hzX5SD-JjVOOSezJxeDoL7Jeu-iPRqZRVm7M646bcNxXsC18_2JF3AJ9feyqJsAOCrnh1HniunxS8lyIejqwM9162uuyuQmfylu1XMtokClPUbUE1rOJLvFa5vGKyCe_imMC7wA8u4r2ys42grspFrBAXHqXz8isPUbMQUfviev-CprvR8GRNEOfri2wLx0V436Eaai5819VVk8uMAxLqK17Tq5Az9JEyEzmkX4PkZX2REZpaYmYcVhF29--B2Uu9lkkeTnWDre4ZmSf7ApZ65Bv570j-7ozkfS2ogIs\";\n\n  const Axiosphoto = value => {\n    const Command = value;\n    console.log(Command);\n\n    if (Command === \"Errormask\") {\n      alert(\"กรุณาถอดหน้ากาก\");\n    } else if (Command === \"FoundData\") {\n      const Data = [\"3640600077526\", \"สมชาย\", \"หมายปอง\"];\n      dispatch(updateSsid(Data[0]));\n      dispatch(updateFirstName(Data[1]));\n      dispatch(updateSsid(Data[2]));\n      alert(\"พบข้อมูล\");\n      Router.push(\"/page.covid4\");\n    } else if (Command === \"NotFoundData\") {\n      alert(\"ไม่พบข้อมูล\");\n    }\n  };\n\n  function taskOne() {\n    return new Promise(async resolve => {\n      const A = async () => {\n        const imageSrc = await webcamRef.current.getScreenshot();\n        const blob = await fetch(imageSrc).then(res => {\n          res.blob();\n          setData(res);\n          console.log(\"success 1\");\n          resolve(res);\n        }).catch(() => console.log(\"error\"));\n      };\n\n      await A();\n    });\n  }\n\n  function taskTwo(value) {\n    return new Promise(async resolve => {\n      const B = async () => {\n        await console.log(\"A\", value);\n        await console.log(\"2\");\n        const formData = await new FormData();\n        await formData.append(\"picture\", img1);\n        return formData;\n      };\n\n      var formData = await B();\n      await console.log(\"3\", formData);\n      await Axios({\n        method: \"post\",\n        url: \"http://34.87.54.114:8003/api/v1/file/uploadphoto\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n          \"Content-Type\": \"multipart/form-data\"\n        },\n        formData\n      }).then(res => {\n        console.log(\"success\", res);\n      }).catch(error => {\n        console.log(\"error\", error);\n      });\n    });\n  }\n\n  function taskThree() {\n    return new Promise(async resolve => {\n      const C = () => {\n        console.log(\"4\");\n      };\n\n      await C();\n      await resolve();\n    });\n  }\n\n  const main = async () => {\n    var result = await taskOne();\n    await taskTwo(result); //await taskThree();\n  };\n\n  const capture = React.useCallback(async () => {\n    //const imageSrc = await webcamRef.current.getScreenshot();\n    main(); //const formData = new FormData();\n    //formData.append('picture');\n    //console.log(formData)\n\n    /*Axios({\r\n        method:\"post\",\r\n        url:\"http://34.87.54.114:8003/api/v1/file/uploadphoto\",\r\n        headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'multipart/form-data'\r\n          },\r\n      data:{ picture:blob}\r\n    }).then((res)=>{\r\n        console.log('success',res)\r\n    }).catch((error)=>{\r\n        console.log('error',error)\r\n    })*/\n    //await console.log(\"1\", data);\n    //await Axiosphoto(\"Errormask\");\n  }, [webcamRef, setImgSrc]);\n  /*useEffect(() => {\r\n    const formData = new FormData();\r\n    if (data === \"\") {\r\n    } else {\r\n      console.log(data);\r\n      formData.append(\"picture.png\", data);\r\n      console.log(formData);\r\n    }\r\n  }, [data]);*/\n\n  const {\n    0: statee,\n    1: setStatee\n  } = useState(null);\n\n  const fileSelectedHandler = event => {\n    setStatee(event.target.files[0]);\n    console.log(event.target.files[0]);\n  };\n\n  const fileUploadHandler = () => {\n    console.log(\"TEST\", statee);\n    const fd = new FormData();\n    fd.append(\"picture\", statee);\n    Axios.post(\"http://34.87.54.114:8003/api/v1/file/uploadphoto\", fd, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n        \"Content-Type\": \"multipart/form-data\"\n      }\n    }).then(res => {\n      console.log(\"success\", res);\n    }).catch(err => {\n      console.log(\"err\", err);\n    });\n  };\n\n  const test = () => {\n    function b64toBlob(b64Data, contentType, sliceSize) {\n      contentType = contentType || \"\";\n      sliceSize = sliceSize || 512;\n      var byteCharacters = atob(b64Data);\n      var byteArrays = [];\n\n      for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\n        var byteNumbers = new Array(slice.length);\n\n        for (var i = 0; i < slice.length; i++) {\n          byteNumbers[i] = slice.charCodeAt(i);\n        }\n\n        var byteArray = new Uint8Array(byteNumbers);\n        byteArrays.push(byteArray);\n      }\n\n      var blob = new Blob(byteArrays, {\n        type: contentType\n      });\n      return blob;\n    }\n\n    var ImageURL = img1;\n    var block = ImageURL.split(\";\");\n    var contentType = block[0].split(\":\")[1];\n    var realData = block[1].split(\",\")[1];\n    var blob = b64toBlob(realData, contentType);\n    console.log(blob);\n  };\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 5\n    }\n  }, __jsx(FormItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 9\n    }\n  }, __jsx(Webcam, {\n    audio: false,\n    ref: webcamRef,\n    screenshotFormat: \"image/jpeg\",\n    style: {\n      borderRadius: \"20px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 11\n    }\n  })), __jsx(_Button, {\n    onClick: capture,\n    style: {\n      width: \"100%\"\n    },\n    type: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 9\n    }\n  }, \"Capture photo\"), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 9\n    }\n  }, __jsx(\"img\", {\n    src: imgSrc,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 11\n    }\n  }), __jsx(\"input\", {\n    type: \"file\",\n    onChange: fileSelectedHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 11\n    }\n  }), __jsx(\"button\", {\n    onClick: fileUploadHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 11\n    }\n  }, \"Upload\"))));\n};\n\nexport default WebcamCapture;","map":{"version":3,"sources":["D:/Coding/covid-web-develop/covid-web-develop/pages/components/component.snapshot.js"],"names":["React","useEffect","useState","Webcam","useDispatch","useSelector","updateFirstName","updateLastName","updateSsid","img1","Router","Axios","FormItem","Item","WebcamCapture","props","dispatch","webcamRef","useRef","data","setData","imgSrc","setImgSrc","SSID","state","post","token","Axiosphoto","value","Command","console","log","alert","Data","push","taskOne","Promise","resolve","A","imageSrc","current","getScreenshot","blob","fetch","then","res","catch","taskTwo","B","formData","FormData","append","method","url","headers","Authorization","error","taskThree","C","main","result","capture","useCallback","statee","setStatee","fileSelectedHandler","event","target","files","fileUploadHandler","fd","err","test","b64toBlob","b64Data","contentType","sliceSize","byteCharacters","atob","byteArrays","offset","length","slice","byteNumbers","Array","i","charCodeAt","byteArray","Uint8Array","Blob","type","ImageURL","block","split","realData","borderRadius","width"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Webcam from \"react-webcam\";\r\nimport {\r\n  Form,\r\n  Select,\r\n  InputNumber,\r\n  DatePicker,\r\n  Switch,\r\n  Slider,\r\n  Button,\r\n} from \"antd\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  updateFirstName,\r\n  updateLastName,\r\n  updateSsid,\r\n} from \"../../store/actions/postAction\";\r\nimport img1 from \"../../public/1.png\";\r\nimport Router from \"next/router\";\r\nimport Axios from \"axios\";\r\n\r\nconst FormItem = Form.Item;\r\n\r\nconst WebcamCapture = (props) => {\r\n  const dispatch = useDispatch();\r\n  const webcamRef = React.useRef(null);\r\n  const [data, setData] = useState(\"\");\r\n  const [imgSrc, setImgSrc] = React.useState(null);\r\n  const { SSID } = useSelector((state) => state.post);\r\n  const token =\r\n    \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mbyI6eyJ1c2VybmFtZSI6ImtrayIsImZpcnN0X25hbWUiOiJiYmJiIiwibGFzdF9uYW1lIjoiY2NjYyIsInJvbGUiOiIzIiwiZGVwYXJ0bWVudF9uYW1lX3RoIjoi4LmA4LmA4Lie4LiX4Lii4LmMIiwiZGVwYXJ0bWVudF9uYW1lX2VuIjoiZG9jdG9yIiwiZGVwYXJ0bWVudF9mdWxsX25hbWUiOiLguYDguYDguJ7guJfguKLguYwifSwiaWF0IjoxNTk1MjYzOTEwLCJleHAiOjE1OTUyNjU3MTB9.SpszxcoVLCt49PKRXq_d9fVL2xT6VMyQwka54554SgZYJzAPDc1REOi_fgj1SppKckXBE5pE63SlHkP1tkifkgUw9FwQiRFEysds0_u4EhRteu4IBy-QMCtJPjieWYQ38HKDns8baLKVBE-kuOhQ9wKEzt4mGDwF-fYHcZ9kzFImkNSHHft_y9HQIb-sjUCNzp6G59YHm75yG1Pqf3rIAeuHk-Vgol_5bX6ANpGGOLJR_vMS9Csk18I9rrRVdZVne45JcEEJBLitVglkU74zxkECXev4yVKCuOPfclPnCuLCal16sUHaA9XNrCYog24fB5CfTOV8Qz3grnH36kKw71sbtUjygJ7Zp4e4f8fJnyjEpP_FJLpi6_VTo-HLqQvi-x6hzX5SD-JjVOOSezJxeDoL7Jeu-iPRqZRVm7M646bcNxXsC18_2JF3AJ9feyqJsAOCrnh1HniunxS8lyIejqwM9162uuyuQmfylu1XMtokClPUbUE1rOJLvFa5vGKyCe_imMC7wA8u4r2ys42grspFrBAXHqXz8isPUbMQUfviev-CprvR8GRNEOfri2wLx0V436Eaai5819VVk8uMAxLqK17Tq5Az9JEyEzmkX4PkZX2REZpaYmYcVhF29--B2Uu9lkkeTnWDre4ZmSf7ApZ65Bv570j-7ozkfS2ogIs\";\r\n\r\n  const Axiosphoto = (value) => {\r\n    const Command = value;\r\n    console.log(Command);\r\n    if (Command === \"Errormask\") {\r\n      alert(\"กรุณาถอดหน้ากาก\");\r\n    } else if (Command === \"FoundData\") {\r\n      const Data = [\"3640600077526\", \"สมชาย\", \"หมายปอง\"];\r\n      dispatch(updateSsid(Data[0]));\r\n      dispatch(updateFirstName(Data[1]));\r\n      dispatch(updateSsid(Data[2]));\r\n      alert(\"พบข้อมูล\");\r\n      Router.push(\"/page.covid4\");\r\n    } else if (Command === \"NotFoundData\") {\r\n      alert(\"ไม่พบข้อมูล\");\r\n    }\r\n  };\r\n\r\n  function taskOne() {\r\n    return new Promise(async (resolve) => {\r\n      const A = async () => {\r\n        const imageSrc = await webcamRef.current.getScreenshot();\r\n        const blob = await fetch(imageSrc)\r\n          .then((res) => {\r\n            res.blob();\r\n            setData(res);\r\n            console.log(\"success 1\");\r\n            resolve(res);\r\n          })\r\n          .catch(() => console.log(\"error\"));\r\n      };\r\n      await A();\r\n    });\r\n  }\r\n  function taskTwo(value) {\r\n    return new Promise(async (resolve) => {\r\n      const B = async () => {\r\n        await console.log(\"A\", value);\r\n        await console.log(\"2\");\r\n        const formData = await new FormData();\r\n        await formData.append(\"picture\", img1);\r\n        return formData;\r\n      };\r\n      var formData = await B();\r\n      await console.log(\"3\", formData);\r\n      await Axios({\r\n        method: \"post\",\r\n        url: \"http://34.87.54.114:8003/api/v1/file/uploadphoto\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n        formData,\r\n      })\r\n        .then((res) => {\r\n          console.log(\"success\", res);\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"error\", error);\r\n        });\r\n    });\r\n  }\r\n  function taskThree() {\r\n    return new Promise(async (resolve) => {\r\n      const C = () => {\r\n        console.log(\"4\");\r\n      };\r\n      await C();\r\n      await resolve();\r\n    });\r\n  }\r\n\r\n  const main = async () => {\r\n    var result = await taskOne();\r\n    await taskTwo(result);\r\n    //await taskThree();\r\n  };\r\n\r\n  const capture = React.useCallback(async () => {\r\n    //const imageSrc = await webcamRef.current.getScreenshot();\r\n    main();\r\n    //const formData = new FormData();\r\n    //formData.append('picture');\r\n    //console.log(formData)\r\n    /*Axios({\r\n        method:\"post\",\r\n        url:\"http://34.87.54.114:8003/api/v1/file/uploadphoto\",\r\n        headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'multipart/form-data'\r\n          },\r\n      data:{ picture:blob}\r\n    }).then((res)=>{\r\n        console.log('success',res)\r\n    }).catch((error)=>{\r\n        console.log('error',error)\r\n    })*/\r\n    //await console.log(\"1\", data);\r\n    //await Axiosphoto(\"Errormask\");\r\n  }, [webcamRef, setImgSrc]);\r\n  /*useEffect(() => {\r\n    const formData = new FormData();\r\n    if (data === \"\") {\r\n    } else {\r\n      console.log(data);\r\n      formData.append(\"picture.png\", data);\r\n      console.log(formData);\r\n    }\r\n  }, [data]);*/\r\n  const [statee, setStatee] = useState(null);\r\n  const fileSelectedHandler = (event) => {\r\n    setStatee(event.target.files[0]);\r\n    console.log(event.target.files[0]);\r\n  };\r\n  const fileUploadHandler = () => {\r\n    console.log(\"TEST\", statee);\r\n    const fd = new FormData();\r\n    fd.append(\"picture\", statee);\r\n    Axios.post(\"http://34.87.54.114:8003/api/v1/file/uploadphoto\", fd, {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    })\r\n      .then((res) => {\r\n        console.log(\"success\", res);\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"err\", err);\r\n      });\r\n  };\r\n\r\n  const test = () => {\r\n    function b64toBlob(b64Data, contentType, sliceSize) {\r\n      contentType = contentType || \"\";\r\n      sliceSize = sliceSize || 512;\r\n\r\n      var byteCharacters = atob(b64Data);\r\n      var byteArrays = [];\r\n\r\n      for (\r\n        var offset = 0;\r\n        offset < byteCharacters.length;\r\n        offset += sliceSize\r\n      ) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n          byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n      }\r\n\r\n      var blob = new Blob(byteArrays, { type: contentType });\r\n      return blob;\r\n    }\r\n    var ImageURL = img1;\r\n    var block = ImageURL.split(\";\");\r\n    var contentType = block[0].split(\":\")[1];\r\n    var realData = block[1].split(\",\")[1];\r\n    var blob = b64toBlob(realData, contentType);\r\n    console.log(blob);\r\n  };\r\n  return (\r\n    <div>\r\n      <FormItem>\r\n        <div>\r\n          <Webcam\r\n            audio={false}\r\n            ref={webcamRef}\r\n            screenshotFormat=\"image/jpeg\"\r\n            style={{ borderRadius: \"20px\" }}\r\n          />\r\n        </div>\r\n        <Button onClick={capture} style={{ width: \"100%\" }} type=\"primary\">\r\n          Capture photo\r\n        </Button>\r\n        <div>\r\n          <img src={imgSrc} />\r\n          <input type=\"file\" onChange={fileSelectedHandler} />\r\n          <button onClick={fileUploadHandler}>Upload</button>\r\n        </div>\r\n      </FormItem>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WebcamCapture;\r\n"]},"metadata":{},"sourceType":"module"}